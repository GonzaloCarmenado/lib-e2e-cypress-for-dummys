<div class="e2e-tree-container">
  <ng-container *ngIf="e2eTree && e2eTree.length > 0; else noContent">
    <ul class="e2e-tree">
      <ng-container *ngFor="let node of e2eTree">
        <ng-template [ngTemplateOutlet]="renderNode" [ngTemplateOutletContext]="{ $implicit: node }"></ng-template>
      </ng-container>
    </ul>
  </ng-container>
  <ng-template #noContent>
    <div class="empty-tree">No se ha encontrado contenido en la carpeta e2e.</div>
  </ng-template>

  <ng-template #renderNode let-node>
    <ng-container *ngIf="node">
      <li *ngIf="node.kind === 'directory'" class="folder-node" style="padding-left: 0;">
        <details open>
          <summary style="padding-left: 0;">ğŸ“ {{ node.name }}</summary>
          <ul>
            <ng-container *ngFor="let child of node.children">
              <ng-template [ngTemplateOutlet]="renderNode"
                [ngTemplateOutletContext]="{ $implicit: child }"></ng-template>
            </ng-container>
          </ul>
        </details>
      </li>
      <li *ngIf="node.kind === 'file'" class="file-node" (click)="onFileClick(node)" style="padding-left: 2em;">
        <span>ğŸ“„ {{ node.name }}</span>
      </li>
    </ng-container>
  </ng-template>
</div>
<div *ngIf="testId">
  <button class="btn btn-success" [disabled]="!saveButtonEnabled" (click)="saveCommandsToFile()">
    Guardar comandos Cypress en el fichero seleccionado
  </button>
  <div *ngIf="!selectedFile" class="mt-2 text-muted">Selecciona un fichero para habilitar el guardado.</div>
  <div *ngIf="selectedFile" class="mt-2 text-success">Fichero seleccionado: {{ selectedFile.name }}</div>
</div>